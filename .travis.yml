language: python
sudo: required
python:
  - "2.7"
services:
  - couchdb
env:
  global:
    - TZ=Europe/Kiev
cache: pip
addons:
  hosts:
   - couchdb
before_install:
  - ./bootstrap.sh
before_script:
  - sudo apt-get -qq update
  - sudo apt-get install -y libsodium-dev
script:
  - ./venv/bin/py.test tests -v --color=yes
  - (set -e; [[ $(git diff) ]] && { git diff | head -n 30; exit 1; } || exit 0)
